/**!
 * artemdemo.popup 
 * version: 0.1.0
 * date: 2015-01-23
 * url: https://github.com/artemdemo/angular-popup
 * 
 */
angular.module("artemdemo.popup",[]).factory("$popup",["$rootScope","$compile","$q","$timeout","$sce",function(a,b,c,d,e){function f(c){var d,e,f,j;h=angular.element(l.popup),f=angular.element(l.backdrop),j=angular.element(l.buttons[c]),h.append(f);for(var m=0;m<j.length;m++)h[0].getElementsByClassName("popup-buttons")[0].appendChild(j[m]);return d=b(h),g=a.$new(),e=d(g),g.POPUP_TYPE="popup-type-"+c,angular.element(document.getElementsByTagName("body")[0]).bind("keyup",function(a){27==a.keyCode&&(k.reject(),i.hide())}),e}var g,h,i={},j="closed",k=null,l={};return l.backdrop=['<div class="popup-backdrop"></div>'].join(""),l.popup=["<popup>","<form>",'<div class="popup-container" ng-class="POPUP_TYPE">','<div class="popup">','<div class="popup-head">','<h3 class="popup-title ng-binding" ng-bind-html="TITLE"></h3>',"</div>",'<div class="popup-body">','<span ng-bind-html="BODY_TXT"></span>',"</div>",'<div class="popup-buttons"></div>',"</div>","</div>","</form>","</popup>"].join(""),l.buttons={},l.buttons.confirm=['<div class="row">','<div class="col-xs-6">','<button ng-click="okAction()" class="btn btn-ok" ng-class="okType || \'btn-block btn-primary\'">{{ OK_TXT }}</button>',"</div>",'<div class="col-xs-6">','<div ng-click="cancelAction()" class="btn btn-cancel" ng-class="cancelType || \'btn-block btn-default\'">{{ CANCEL_TXT }}</div>',"</div>","</div>"].join(""),l.buttons.show=['<button ng-click="okAction($event)" class="btn btn-ok" ng-class="okType || \'btn-block btn-primary\'">{{ OK_TXT }}</button>'].join(""),i.show=function(a){var b;if(k=c.defer(),"open"==j)return!1;j="open",a=angular.isObject(a)?a:{},b=f("show"),g.TITLE=a.hasOwnProperty("title")?a.title:"",g.BODY_TXT=a.hasOwnProperty("template")?e.trustAsHtml(a.template):"",g.OK_TXT=a.hasOwnProperty("okText")?a.okText:"Ok",g.okType=a.hasOwnProperty("okType")?a.okType:"";for(var d=0;d<b.length;d++)document.body.appendChild(b[d]);return h.find("button")[0].focus(),g.okAction=function(){k.resolve(),i.hide()},k.promise},i.confirm=function(a){var b,l;if(k=c.defer(),"open"==j)return!1;j="open",a=angular.isObject(a)?a:{},b=f("confirm"),g.TITLE=a.hasOwnProperty("title")?a.title:"",g.BODY_TXT=a.hasOwnProperty("template")?e.trustAsHtml(a.template):"",g.CANCEL_TXT=a.hasOwnProperty("cancelText")?a.cancelText:"Cancel",g.cancelType=a.hasOwnProperty("cancelType")?a.cancelType:"",g.OK_TXT=a.hasOwnProperty("okText")?a.okText:"Ok",g.okType=a.hasOwnProperty("okType")?a.okType:"";for(var m=0;m<b.length;m++)document.body.appendChild(b[m]);return g.cancelAction=function(){k.reject(),i.hide()},d(function(){l=h.find("input"),l.length>0?l[0].focus():h.find("button")[0].focus()}),g.okAction=function(b){var c=!1;c=a.hasOwnProperty("okTap")&&angular.isFunction(a.okTap)?a.okTap(b):!0,k.resolve(c),c&&i.hide()},k.promise},i.hide=function(){g.$destroy(),j="closed";for(var a=0;a<h.length;a++)h.remove();angular.element(document.getElementsByTagName("body")[0]).unbind("keyup")},i}]);